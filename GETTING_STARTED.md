# 医療文書要約ツール - クイックスタートガイド

## 1. セットアップ（初回のみ）

### ステップ1: 依存ライブラリのインストール

ターミナルを開いて、プロジェクトディレクトリに移動します：

```bash
cd /Users/signakada/Documents/自作アプリ/SummaryForDoc
```

依存ライブラリをインストール：

```bash
pip3 install -r requirements.txt
```

### ステップ2: Tesseract OCRのインストール（画像読み込み用）

**Mac:**
```bash
brew install tesseract
brew install tesseract-lang
```

**Windows:**
[Tesseract のダウンロードページ](https://github.com/UB-Mannheim/tesseract/wiki)からインストーラーをダウンロードし、インストール時に「日本語」を選択してください。

### ステップ3: APIキーの設定

プロジェクトのルートディレクトリに `.env` ファイルがあります。
このファイルを編集して、実際のAPIキーを記載してください：

```bash
# .envファイルを編集
nano .env
```

以下のように記載：

```
# Claudeを使う場合（推奨）
ANTHROPIC_API_KEY=sk-ant-api03-xxxxxxxxxxxxx

# 使用するAI
AI_PROVIDER=anthropic

# 使用するモデル
AI_MODEL=claude-3-5-haiku-20241022
```

**APIキーの取得方法:**
- **Claude**: https://console.anthropic.com/ でアカウント作成 → API Keys → Create Key
- **OpenAI**: https://platform.openai.com/ でアカウント作成 → API Keys

保存して閉じます（nano の場合: `Ctrl+O` → `Enter` → `Ctrl+X`）

---

## 2. アプリの起動

### GUIアプリを起動

```bash
python3 main.py
```

すると、Fletアプリが起動します。

---

## 3. 使い方

### 基本的な流れ

1. **ファイルを選択**
   - 「ファイルを選択」ボタンをクリック
   - または、ファイルをウィンドウにドラッグ&ドロップ
   - 対応形式: `.txt`, `.pdf`, `.jpg`, `.png`
   - 複数ファイルOK

2. **出力オプションを選択**
   - ☑ 病歴（200-300文字）
   - ☑ 症状の詳細（200-300文字）
   - ☑ 全期間サマリー（詳細版）

3. **テンプレートを選択**
   - 障害年金診断書（標準）
   - 精神障害者保健福祉手帳
   - 自立支援医療

4. **実行**
   - 「個人情報を削除して要約作成」ボタンをクリック
   - 処理中は「処理中...」と表示されます

5. **結果を確認**
   - 画面に表示された要約を確認
   - 各項目の「コピー」ボタンでクリップボードにコピー
   - または、自動的に `output/` フォルダに保存されます

---

## 4. 出力ファイル

生成されたファイルは `output/` ディレクトリに保存されます：

```
output/
├── 病歴_20241029_230500.txt
├── 症状の詳細_20241029_230500.txt
└── 全期間サマリー_20241029_230500.txt
```

---

## 5. トラブルシューティング

### エラー: 「APIキーが設定されていません」

`.env` ファイルにAPIキーが正しく設定されているか確認してください。

```bash
cat .env
```

### エラー: 「Tesseract not found」

Tesseract OCRがインストールされていません。上記の手順でインストールしてください。

### 画像からテキストがうまく抽出できない

- 画像が鮮明か確認してください
- 解像度が低い場合は、スキャンし直してください
- 手書き文字の認識精度は低いです

### 個人情報が完全に削除されない

このツールの個人情報削除機能は100%完璧ではありません。
**必ず出力結果を目視で確認してください。**

---

## 6. 料金について

このツールは、AnthropicまたはOpenAIのAPIを使用します。

**目安:**
- Claude 3.5 Haiku: 1回あたり数円〜十数円
- GPT-4o-mini: 1回あたり数円

使用量に応じて料金が発生しますので、APIダッシュボードで確認してください。

---

## 7. 次のステップ

### カスタムプロンプトを作成したい

`src/prompts.py` を編集して、独自のテンプレートを追加できます。

### 実行ファイル化（配布用）

```bash
# Mac用
flet pack main.py --name "医療文書要約ツール"

# Windows用
flet pack main.py --name "医療文書要約ツール" --icon icon.ico
```

---

## サポート

問題が発生した場合は、以下を確認してください：

1. Python 3.9以上がインストールされているか
2. すべての依存ライブラリがインストールされているか
3. APIキーが正しく設定されているか
4. Tesseract OCRがインストールされているか（画像使用時）

それでも解決しない場合は、エラーメッセージを記録してください。
